---
title: "NewYorkShootings"
author: "Brian de Korodi & Mariane Modena"
format: html
editor: visual
---

# Gun violence in the Big Apple: How shooting incidents help to tell the story of New York City over the last 15 years.

A city of bright lights and big dreams, New York's history is also one of crime, violence and social inequality. This is why we will attempt to tell the story of New York City through the lens of its shooting incidents.

Through geographical, sociodemographic and temporal aspects of reported shooting incidents in New York City, we attempt to find relevant trends that might align with social and economic developments between 2006 and 2022.

We have found certified data with detailed descriptive characteristics of all reported shooting incidents, including date, time, location, victim and offender's characteristics. This will allow us to summarize the quantity of shooting incidents as a function of these characteristics, along with their evolution over the given timeframe. Where significant patterns reveal themselves, we will attempt to use external information to help explain these patterns in light of various contextual factors, such as political, social, or economic evolutions.Â 

This method, combining descriptive data with contextual information, we hope, will allow us to determine to what extent gun violence incidents are random events, or whether they may be partially explained by larger social and economic forces.

## Click [here](https://github.com/briandekorodi/NewYorkShootings) to access the Github repository

## Click [here](https://catalog.data.gov/dataset/nypd-shooting-incident-data-historic/resource/c564b578-fd8a-4005-8365-34150d306cc4) to access the source

## Description of the source 

The data, found in the official United States open data website, constitutes a list of every New York City shooting incident, reported by the NYPD, from January 1, 2006 to Decemeber 31, 2022. This data is manually extracted every quarter and reviewed by the Office of Management Analysis and Planning before being posted on the NYPD website.

For each observation, corresponding to a unique shooting incident, is provided information relative to the date, time and localisation of the incident, as well as socio-demographic characteristics of the offender and victim.

## Description of the variables 

**INCIDENT_KEY** : Serial number identifying the incident

**OCCUR_DATE** : Date (Month/Day/Year) on which the incident occurred

**OCCUR_TIME** : Time at which the incident occured

**BORO** : Which of the 5 New York City boroughs the incident occurred in (Manhattan, Queens, Brooklyn, Bronx, Staten Island)

**LOC_OF_OCCUR_DESC** : Most general category of location, whether the incident occurred inside ,outside, or unknown

**PRECINCT** : Code identifying which NYPD precinct in which the incident occurred

**JURISDICTION_CODE** : Code identifying the tax jurisdiction territory in which the incident occurred

**LOC_CLASSFCTN_DESC** : Second most general category of location

**LOCATION_DESC** : Third most general category of location

**STATISTICAL_MURDER_FLAG** : TRUE/FALSE variable indicating whether the shooting resulted in a murder

**PERP_AGE_GROUP** : Age range of the offender

**PERP_SEX** : Sex of the offender

**PERP_RACE** : Racial group of the offender

**VIC_AGE_GROUP** : Age range of the victim

**VIC_SEX** : Sex of the victim

**VIC_RACE** : Racial group of the victim

**X_COORD_CD** : Cartesian X coordinate of the location at which the shooting incident occurred

**Y_COORD_CD** : Cartesian Y coordinate of the location at which the shooting incident occurred

**Latitude** : Geographical latitude coordinate of the location at which the shooting incident occurred

**Longitude** : Geographical longitude coordinate of the location at which the shooting incident occurred

**Lon_Lat** : Geographical point, composed of latitude and longitude coordinates, of the location at which the shooting incident occurred

## Loading the data

```{r}
#| message: FALSE
here::i_am("NewYorkShootings.Rproj")
```

```{r}
library(vroom)
```

```{r}
raw_data <- vroom("data/NYPD_Shooting_Incident_Data__Historic.csv")
```

## Basic information about the data file 

```{r}
#| message: FALSE
library(dplyr)
```

```{r}
basic_info <- raw_data |>
  summarise("Name of the file" = "NYPD_Shooting_Incident_Data_Historic",
            "Number of observations" = nrow(raw_data),
            "Number of variables" = ncol(raw_data),)
knitr::kable(basic_info)

```

## Data Cleaning

We create a new dataset on which we will implement our cleaning steps.

```{r}
clean_data <- raw_data
```

### Wrong types

The variable OCCUR_TIME has a double type, which is not very readable.

```{r}
clean_data[["OCCUR_TIME"]] |> typeof()
```

We us as_hms to convert it from double to time.

```{r}
library(hms)
clean_data[["OCCUR_TIME"]] <- clean_data[["OCCUR_TIME"]] |> as_hms()
```

### Inconsistent labeling of missing values

The dataset contains some inconsistencies in the entry of missing values. Some missing values are labeled NA, while others are labeled with some other character value, such as "(null)", "UNKNOWN", "U", or "OTHER". We convert all of these to NA.

#### Null

The location description and offender age group variables contain missing values that have the notation "(null)".

```{r}
clean_data |> distinct(LOCATION_DESC)
```

```{r}
clean_data |> distinct(PERP_AGE_GROUP)
```

We replace all the "(null)" values in the dataset by NA.

```{r}
clean_data[clean_data == "(null)"] <- NA
```

#### NONE

The location description variable contains some missing values labeled as NONE. We replace these by NA.

```{r}
clean_data <- clean_data |>
  mutate(LOCATION_DESC = replace(LOCATION_DESC, LOCATION_DESC == "NONE", NA))
```

#### UNKNOWN

The victim age group variable contains some missing values labeled as UNKNOWN. We replace these by NA.

```{r}
clean_data |> distinct(VIC_AGE_GROUP)
```

```{r}
clean_data |> distinct(PERP_AGE_GROUP)
```

```{r}
clean_data <- clean_data |>
  mutate(VIC_AGE_GROUP = ifelse(VIC_AGE_GROUP %in% c("UNKNOWN"), NA, VIC_AGE_GROUP))
```

```{r}
clean_data <- clean_data |>
  mutate(PERP_AGE_GROUP = ifelse(PERP_AGE_GROUP %in% c("UNKNOWN"), NA, PERP_AGE_GROUP))
```

#### OTHER

The location classification variable contains some missing values labeled as OTHER. We replace these by NA.

```{r}
clean_data |> distinct(LOC_CLASSFCTN_DESC)
```

```{r}
clean_data <- clean_data |>
  mutate(LOC_CLASSFCTN_DESC = replace(LOC_CLASSFCTN_DESC, LOC_CLASSFCTN_DESC == "OTHER", NA))
```

#### U

The victim and offender sex variables contain some missing values labeled as U. We replace these by NA.

```{r}
clean_data |> distinct(PERP_SEX)
```

```{r}
clean_data |> distinct(VIC_SEX)
```

```{r}
clean_data <- clean_data |>
  mutate(PERP_SEX = replace(PERP_SEX, PERP_SEX == "U", NA))
```

```{r}
clean_data <- clean_data |>
  mutate(VIC_SEX = replace(VIC_SEX, VIC_SEX == "U", NA))
```

### Impossible values

The victim and offender age group variables contain some absurd values. It is impossible that the victim's age be 1022, or that the offender's age be 1020, 940 or 224. We replace these values by NA.

```{r}
clean_data |> distinct(VIC_AGE_GROUP)
```

```{r}
clean_data |> distinct(PERP_AGE_GROUP)
```

```{r}
clean_data <- clean_data |>
  mutate(VIC_AGE_GROUP = ifelse(VIC_AGE_GROUP %in% c("1022"), NA, VIC_AGE_GROUP))
```

```{r}
clean_data <- clean_data |>
  mutate(PERP_AGE_GROUP = ifelse(PERP_AGE_GROUP %in% c("1020", "940", "224"), NA, PERP_AGE_GROUP))
```

### Typos

The location description variable contains some values with typos. We correct these.

```{r}
clean_data |> distinct(LOCATION_DESC)
```

```{r}
clean_data <- clean_data |>
  mutate(LOCATION_DESC = recode(LOCATION_DESC, "MULTI DWELL - PUBLIC HOUS" =  "MULTI DWELL - PUBLIC HOUSE", 
                                "SOCIAL CLUB/POLICY LOCATI" = "SOCIAL CLUB/POLICY LOCATION"))
```
