"0","life_reformating <- function(life_df) {"
"0","  single_valued <- function(my_var) {"
"0","    (my_var |> unique() |> length()) == 1"
"0","  }"
"0","  region_codes <- life_df |> "
"0","    distinct(ParentLocationCode, ParentLocation) |>"
"0","    rename(Region = ParentLocationCode, RegionName = ParentLocation)"
"0","  country_codes <- life_df |> "
"0","    distinct(SpatialDimValueCode, Location) |>"
"0","    rename(Country = SpatialDimValueCode, CountryName = Location)"
"0","  life <- life_df |>"
"0","    select(-ParentLocation, -Location) |>"
"0","    rename(Region = ParentLocationCode, Country = SpatialDimValueCode) |>"
"0","    select(!where(\(.x) all(is.na(.x))))"
"0","  single_values <- life |> "
"0","    select(where(single_valued)) |> "
"0","    slice_head()"
"0","  life <- life |>"
"0","    select(-FactValueNumeric, -Dim1ValueCode, -DateModified) |>"
"0","    select(!where(single_valued)) |>"
"0","    rename(Year = Period,"
"0","           Attribute = Dim1)"
"0","  list(region_codes = region_codes,"
"0","       country_codes = country_codes,"
"0","       constants = single_values,"
"0","       life_expectancy = life)"
"0","}"
